<!DOCTYPE html>













<html class="theme-next mist" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"/>

<link rel="stylesheet" href="/css/main.css?v=7.0.0"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    version: '7.0.0',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="部分题目来源：美团 java 后台 哈尔滨现场面试面经 1. 数据库主从同步、读写分离主要用来提升数据库的并发负载能力。  数据的热备； 架构的扩展； 支持更大的并发；  主从复制的步骤：  从库生成两个线程，一个 IO 线程，一个 SQL 线程； IO 线程去请求主库的 binlog，并将得到的 binlog 日志写入 relay log 文件中。主库会生成一个 binlog dump 线程，用">
<meta property="og:type" content="article">
<meta property="og:title" content="面经整理3">
<meta property="og:url" content="http://yoursite.com/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/index.html">
<meta property="og:site_name" content="To the moon">
<meta property="og:description" content="部分题目来源：美团 java 后台 哈尔滨现场面试面经 1. 数据库主从同步、读写分离主要用来提升数据库的并发负载能力。  数据的热备； 架构的扩展； 支持更大的并发；  主从复制的步骤：  从库生成两个线程，一个 IO 线程，一个 SQL 线程； IO 线程去请求主库的 binlog，并将得到的 binlog 日志写入 relay log 文件中。主库会生成一个 binlog dump 线程，用">
<meta property="og:locale">
<meta property="og:image" content="http://yoursite.com/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%9B%BE.jpeg">
<meta property="og:image" content="http://yoursite.com/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/12.jpg">
<meta property="article:published_time" content="2018-12-14T01:05:49.000Z">
<meta property="article:modified_time" content="2023-05-08T16:33:08.913Z">
<meta property="article:author" content="Harrison Lee &#x2F; Email (harrisonli60@163.com)">
<meta property="article:tag" content="javaWeb">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%9B%BE.jpeg">






  <link rel="canonical" href="http://yoursite.com/2018/12/14/面经整理3/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>面经整理3 | To the moon</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    
<!-- 以下修改 -->
    <a target="_blank" rel="noopener" href="https://github.com/dafeigefeifeifei"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149" alt="Fork me on GitHub"></a>

</div>
<!-- 以上修改 -->

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">To the moon</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">A Coder,a Programmer,a Developer</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Harrison Lee / Email (harrisonli60@163.com)"/>
      <meta itemprop="description" content="It is never too late to learn a new skill, even a challenging one."/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="To the moon"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">面经整理3

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-14 09:05:49" itemprop="dateCreated datePublished" datetime="2018-12-14T09:05:49+08:00">2018-12-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2023-05-09 00:33:08" itemprop="dateModified" datetime="2023-05-09T00:33:08+08:00">2023-05-09</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/interview/" itemprop="url" rel="index"><span itemprop="name">interview</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>部分题目来源：<a target="_blank" rel="noopener" href="https://www.nowcoder.com/discuss/108195">美团 java 后台 哈尔滨现场面试面经</a></p>
<h4 id="1-数据库主从同步、读写分离"><a href="#1-数据库主从同步、读写分离" class="headerlink" title="1. 数据库主从同步、读写分离"></a>1. 数据库主从同步、读写分离</h4><p>主要用来提升数据库的并发负载能力。</p>
<ul>
<li>数据的热备；</li>
<li>架构的扩展；</li>
<li>支持更大的并发；</li>
</ul>
<p>主从复制的步骤：</p>
<ol>
<li>从库生成两个线程，一个 IO 线程，一个 SQL 线程；</li>
<li>IO 线程去请求主库的 binlog，并将得到的 binlog 日志写入 relay log 文件中。主库会生成一个 binlog dump 线程，用来给从库的 IO 线程传 binlog；<ul>
<li>binlog是一个二进制格式的文件，用于记录用户对数据库更新的SQL语句信息（查询不会有记录，只记录增删改）。在 my.cnf 中增加<code>log_bin</code>参数即可开启。</li>
</ul>
</li>
<li>SQL 线程，会读取 relay log 文件中的日志（从 Exec_Master_Log_Pos 位置开始执行），并解析成具体操作，来实现主从的操作一致，而最终数据一致。</li>
</ol>
<p>缺点：</p>
<ol>
<li>数据的实时性较差；</li>
<li>数据量大时，同步效率差；</li>
<li>同时连接多个数据库，容易引起混乱；</li>
<li>读具有高性能高可靠性和可伸缩。只读服务器因为没有写操作，大大减轻磁盘 IO 等性能问题；多个只读服务器可以采用负载均衡的方式实现可伸缩性。</li>
<li>写数据的分配一般采用哈希映射。</li>
</ol>
<span id="more"></span>

<p>推荐阅读：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/DarkAngel1228/article/details/80004222">MySQL主从复制面试之作用和原理</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012170724/article/details/50976886">数据库（二）读写分离</a></p>
<h4 id="2-MySQL-上主从同步如何配置，工作原理"><a href="#2-MySQL-上主从同步如何配置，工作原理" class="headerlink" title="2. MySQL 上主从同步如何配置，工作原理"></a>2. MySQL 上主从同步如何配置，工作原理</h4><ol>
<li>设置多个数据库服务器。</li>
<li>打开 master 上的 binlog，设置 slave 上的 relay-log。</li>
<li>将 master 和 slave 服务器关联起来，在 master 中执行：</li>
</ol>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">create</span> <span class="keyword">user</span> repl;</span><br><span class="line">mysql&gt; <span class="keyword">GRANT</span> <span class="keyword">REPLICATION</span> SLAVE <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">&#x27;repl&#x27;</span>@<span class="string">&#x27;从xxx.xxx.xxx.xx&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;mysql&#x27;</span>;</span><br><span class="line">mysql&gt; flush <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建一个数据库用户 repl，密码是 mysql，在 slave 中使用 repl 这个账号和 master 连接时，就赋予其 replication slave 的权限，<code>*.*</code>表示这个权限是针对 master 的所有表，其中<code>***</code>就是 slave 的 ip 地址。</li>
<li>进入 slave 数据库后执行以下代码：</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; change master to master_host=<span class="string">&#x27;主xxx.xxx.xxx.xx&#x27;</span>,master_port=<span class="number">3306</span>,master_user=<span class="string">&#x27;repl&#x27;</span>,master_password=<span class="string">&#x27;mysql&#x27;</span>,master_log_file=<span class="string">&#x27;master-bin.000001&#x27;</span>,master_log_pos=<span class="number">0</span>;</span><br><span class="line">mysql&gt;start slave; <span class="regexp">//</span> 开启主从同步</span><br><span class="line">mysql&gt;stop slave; <span class="regexp">//</span> 关闭主从同步</span><br><span class="line">mysql&gt;show slave status \G; <span class="regexp">//</span> 查看状态命令</span><br></pre></td></tr></table></figure>

<p>Ps:上面的<code>master_log_file=&#39;master-bin.000001&#39;</code>是配置 binlog 和 relay-log 后，执行<code>SHOW MASTER STATUS</code>命令后查到的。</p>
<ol start="4">
<li>此时在 master 数据库进行的操作，都会在 slave 库中执行了。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/starlh35/article/details/78735510">数据库读写分离，主从同步实现方法</a></p>
<h4 id="3-线程的状态转换图"><a href="#3-线程的状态转换图" class="headerlink" title="3. 线程的状态转换图"></a>3. 线程的状态转换图</h4><p><img src="/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%9B%BE.jpeg" alt="线程状态图"></p>
<p>Java 线程具有六种基本状态：</p>
<ol>
<li>初始(NEW)：新创建了一个线程对象，但还没有调用start()方法。</li>
<li>运行(RUNNABLE)：Java线程中将<strong>就绪</strong>（ready）和<strong>运行中</strong>（running）两种状态笼统的称为“运行”。<br>线程对象创建后，其他线程(比如main线程）调用了该对象的start()方法。该状态的线程位于可运行线程池中，等待被线程调度选中，获取CPU的使用权，此时处于就绪状态（ready）。就绪状态的线程在获得CPU时间片后变为运行中状态（running）。</li>
<li>阻塞(BLOCKED)：表示线程阻塞于锁。</li>
<li>等待(WAITING)：进入该状态的线程需要等待其他线程做出一些特定动作（通知或中断）。</li>
<li>超时等待(TIMED_WAITING)：该状态不同于WAITING，它可以在指定的时间后自行返回。</li>
<li>终止(TERMINATED)：表示该线程已经执行完毕。</li>
</ol>
<p>参考阅读：<a target="_blank" rel="noopener" href="https://blog.csdn.net/pange1991/article/details/53860651">Java 线程的 6 种状态及切换(透彻讲解)</a></p>
<h4 id="4-wait-和sleep-的区别"><a href="#4-wait-和sleep-的区别" class="headerlink" title="4. wait()和sleep()的区别"></a>4. wait()和sleep()的区别</h4><ol>
<li>wait()：当前线程让出锁和同步资源，进入等待队列，等待调用 notify()&#x2F;notifyAll()唤醒指定线程或者所有线程，被唤醒的线程需要重新参与线程的调度，而不会直接获得 CPU。而且，wait()方法只能在同步方法&#x2F;块中使用。</li>
<li>sleep()：当前正在执行的线程休眠一段时间，主动让出 CPU，但是不让出锁和同步资源。到时间后，自动恢复，CPU 继续执行该线程。</li>
</ol>
<h4 id="5-手撕代码：给定大小为n的数组，找出第K小的元素"><a href="#5-手撕代码：给定大小为n的数组，找出第K小的元素" class="headerlink" title="5. 手撕代码：给定大小为n的数组，找出第K小的元素"></a>5. 手撕代码：给定大小为n的数组，找出第K小的元素</h4><p>首先看一个简单的：最坏情况下如何利用 n+logN-2 次比较找到n个元素中的第2小的元素？</p>
<p>采用 tournament method 算法：对数组a[1…n]中元素成对的做比较，每次比较后将较小的数拿出，形成的数组再继续这样处理，直到剩下最后的一个，就是数组中最小的那个。将这个过程以一个树的形式表现出来,如下图：</p>
<p><img src="/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%863/12.jpg" alt="12"></p>
<p>在这个过程中，非树叶节点就是比较的次数，一共进行了n-1次比较，树根即为最小的元素。而第二小的元素一定是在这个过程中与根节点进行过比较的元素。即上图中5，3和2。这样的节点最多有 logN 个，在这些节点中找到最小的元素需要进行-1次比较。因此总共所需的比较次数为n-1 +logN-1&#x3D;n+ logN -2次。</p>
<h5 id="长度为-n-的数组中，寻找第-K-小的元素"><a href="#长度为-n-的数组中，寻找第-K-小的元素" class="headerlink" title="长度为 n 的数组中，寻找第 K 小的元素"></a>长度为 n 的数组中，寻找第 K 小的元素</h5><p>建大根堆。建立一个包含K个元素的最大堆，将后续的N-K每个数与堆顶元素比较，如果小于堆顶元素，则将其替换堆顶元素并调整堆得结构维护最大堆的性质，最后堆中包含有最小的K个元素，从而堆顶元素就是第K小的数。建堆的时间为O(K)，每次调整最大堆结构时间为O(lgK)，从而总的时间复杂度为O(K + (N-K)lgK)。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*得到第K小的数*/</span></span><br><span class="line"><span class="built_in">int</span> min<span class="constructor">K(<span class="params">int</span> A[], <span class="params">int</span> N, <span class="params">int</span> K)</span> &#123;</span><br><span class="line">    <span class="built_in">int</span> heap<span class="literal">[K+<span class="number">1</span>]</span>;</span><br><span class="line">    build<span class="constructor">_max_heap(<span class="params">heap</span>, A, K)</span>; <span class="comment">//以数组A的前K个元素建立大小为K的最大堆</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=K+<span class="number">1</span>; i&lt;=N; i++) &#123; <span class="comment">//遍历A[K+1]到A[N]，如果有小于堆顶元素，则替换堆顶元素并保持堆的性质。</span></span><br><span class="line">        <span class="keyword">if</span> (A<span class="literal">[<span class="identifier">i</span>]</span> &lt; heap<span class="literal">[<span class="number">1</span>]</span>) &#123;</span><br><span class="line">            heap<span class="literal">[<span class="number">1</span>]</span> = A<span class="literal">[<span class="identifier">i</span>]</span>;</span><br><span class="line">            max<span class="constructor">_heapify(<span class="params">heap</span>, 1, K)</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return heap<span class="literal">[<span class="number">1</span>]</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*采用插入方法建立堆*/</span></span><br><span class="line">void build<span class="constructor">_max_heap(<span class="params">int</span> <span class="params">heap</span>[], <span class="params">int</span> A[], <span class="params">int</span> K)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> heapsize = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">1</span>; i&lt;=K; i++) &#123;</span><br><span class="line">        max<span class="constructor">_heap_insert(<span class="params">heap</span>, A[<span class="params">i</span>], <span class="params">heapsize</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*将key插入到堆中，并保证最大堆的性质*/</span></span><br><span class="line">void max<span class="constructor">_heap_insert(<span class="params">int</span> <span class="params">heap</span>[], <span class="params">int</span> <span class="params">key</span>, <span class="params">int</span> &amp;<span class="params">heapsize</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    heapsize++;</span><br><span class="line">    heap<span class="literal">[<span class="identifier">heapsize</span>]</span> = INT_MIN;</span><br><span class="line">    heap<span class="constructor">_increase_key(<span class="params">heap</span>, <span class="params">heapsize</span>, <span class="params">key</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*将堆中heap[i]的关键字增大为key*/</span></span><br><span class="line">void heap<span class="constructor">_increase_key(<span class="params">int</span> <span class="params">heap</span>[], <span class="params">int</span> <span class="params">i</span>, <span class="params">int</span> <span class="params">key</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">assert</span>(key &gt;= heap<span class="literal">[<span class="identifier">i</span>]</span>);</span><br><span class="line">    heap<span class="literal">[<span class="identifier">i</span>]</span> = key;</span><br><span class="line">    <span class="keyword">while</span> (i&gt;<span class="number">1</span><span class="operator"> &amp;&amp; </span>heap<span class="literal">[<span class="identifier">parent</span>(<span class="identifier">i</span>)]</span>&lt;heap<span class="literal">[<span class="identifier">i</span>]</span>) &#123;</span><br><span class="line">        swap(heap, i, parent(i));</span><br><span class="line">        i = parent(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*保持堆的性质*/</span> </span><br><span class="line">void max<span class="constructor">_heapify(<span class="params">int</span> A[], <span class="params">int</span> <span class="params">i</span>, <span class="params">int</span> <span class="params">heapsize</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> l = left(i);</span><br><span class="line">    <span class="built_in">int</span> r = right(i);</span><br><span class="line">    <span class="built_in">int</span> largest = i;</span><br><span class="line">    <span class="keyword">if</span> (l&lt;=heapsize<span class="operator"> &amp;&amp; </span>A<span class="literal">[<span class="identifier">l</span>]</span>&gt;A<span class="literal">[<span class="identifier">i</span>]</span>)</span><br><span class="line">        largest = l;</span><br><span class="line">    <span class="keyword">if</span> (r&lt;=heapsize<span class="operator"> &amp;&amp; </span>A<span class="literal">[<span class="identifier">r</span>]</span>&gt;A<span class="literal">[<span class="identifier">largest</span>]</span>)</span><br><span class="line">        largest = r;</span><br><span class="line">    <span class="keyword">if</span> (largest != i) &#123;</span><br><span class="line">        swap(A, i, largest);</span><br><span class="line">        max<span class="constructor">_heapify(A, <span class="params">largest</span>, <span class="params">heapsize</span>)</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-线程同步的方法"><a href="#6-线程同步的方法" class="headerlink" title="6.  线程同步的方法"></a>6.  线程同步的方法</h4><p>推荐阅读：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u010842515/article/details/65443084">Synchronized 同步静态方法和非静态方法总结</a></p>
<ul>
<li><p>Synchronized 修饰非静态方法时，相当于对调用该方法的<strong>对象</strong>加锁。</p>
<ul>
<li>同一个对象，在两个线程中分别访问该对象的两个同步方法，会产生互斥。</li>
<li>不同对象在两个线程中调用同一个同步方法，不会产生互斥。</li>
</ul>
</li>
<li><p>Synchronized 修饰静态方法时，相当于对该<strong>类</strong>加锁。</p>
<ul>
<li>用类直接在两个线程中调用两个不同的同步方法，会产生互斥。</li>
<li>用一个类的静态成员对象在两个线程中调用静态方法和非静态方法，会产生互斥。</li>
<li>一个类的普通对象在两个线程中分别调用一个静态同步方法和一个非静态方法，不会产生互斥。</li>
</ul>
</li>
<li><p>同步方法：可以是静态和非静态方法，不可以是抽象和接口方法。</p>
<ul>
<li>当一个线程调用这个对象的同步方法，则这个对象的其他所有同步方法将被锁定，不能被调用，但非同步方法可以被另外的线程调用。</li>
</ul>
</li>
</ul>
<h4 id="7-spring-管理的controller是单例的，怎么实现的？"><a href="#7-spring-管理的controller是单例的，怎么实现的？" class="headerlink" title="7. spring 管理的controller是单例的，怎么实现的？"></a>7. spring 管理的controller是单例的，怎么实现的？</h4><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/discuss/111444">问题来自海康一面</a></p>
<p>Spring 的 Controller 默认是 Singleton 的，这意味着每个 request  过来，系统都会用原有的 instance 去处理，这样导致了两个结果:</p>
<ol>
<li>一是我们不用每次创建 Controller；</li>
<li>二是减少了对象创建和垃圾收集的时间。</li>
</ol>
<ul>
<li>由于只有一个 Controller 的 instance，当多个线程调用它的时候，它里面的 instance 变量就不是线程安全的了，会发生窜数据的问题。当然大多数情况下，我们根本不需要考虑线程安全的问题，比如 dao,service 等，除非在 bean 中声明了实例变量。因此，我们在使用 spring mvc 的 controller 时，应避免在 controller 中定义实例变量。</li>
<li>如果一定要使用成员变量，可以采用以下方式：<ul>
<li>在 Controller 中声明 scope&#x3D;”prototype” ，即设置为多例模式。</li>
<li>在 Controller 中使用 ThreadLoader 变量。</li>
</ul>
</li>
</ul>
<p>实现：因为 spring 的 controller 默认就是单例，所以当 spring 创建 applicationContext 容器时，spring 会先初始化所有的该作用域实例，加上 lazy-init 就可以避免预处理。</p>
<h4 id="8-为什么使用JDBC-时需要反射"><a href="#8-为什么使用JDBC-时需要反射" class="headerlink" title="8. 为什么使用JDBC 时需要反射"></a>8. 为什么使用JDBC 时需要反射</h4><ol>
<li>通过反射获取<code>Class.forName(&quot;..Driver&quot;)</code>所在线程的上下文类加载器（通常是系统类加载器）。</li>
<li>利用类加载器，加载数据库驱动并初始化，其中有个 boolean 判断。</li>
<li>判断通过，则返回 Connection（即数据库厂商提供的实例）。</li>
</ol>
<p>主要原因：因为 JVM 双亲委托机制的限制，启动类加载器不可能加载得到第三方厂商提供的具体实验。有了线程上下文类加载器，启动类加载器（根加载器）反倒需要委托子类加载器去加载厂商提供的实现。<br>将父委托变成子委托的方式。</p>
<p>参考《Java 高并发编程详解》第11章 P178 详述<br>也可以参考<a target="_blank" rel="noopener" href="http://likehui.fun/2019/01/11/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%865/">面经整理5</a>的第 2 题</p>
<h4 id="9-mysql-中-char-和-varchar-的区别"><a href="#9-mysql-中-char-和-varchar-的区别" class="headerlink" title="9. mysql 中 char 和 varchar 的区别"></a>9. mysql 中 char 和 varchar 的区别</h4><ol>
<li>char 和 varchar 在存储和检索方面有所不同。</li>
<li>char 长度为创建表时声明的长度（定长），长度值范围在 1 到 255。Varchar 存储可变长的字符数据。而且varchar 会用额外的字节来记录字符串的长度。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Gane_Cheng/article/details/52316408">推荐阅读</a></p>
<h4 id="10-BLOB和TEXT有什么区别？"><a href="#10-BLOB和TEXT有什么区别？" class="headerlink" title="10. BLOB和TEXT有什么区别？"></a>10. BLOB和TEXT有什么区别？</h4><ol>
<li>BLOB是一个二进制对象，可以容纳可变数量的数据。TEXT是一个不区分大小写的BLOB。</li>
<li>BLOB和TEXT类型之间的唯一区别在于对BLOB值进行排序和比较时区分大小写（即有排序规则和字符集），对TEXT值不区分大小写（即没有排序规则和字符集）。</li>
<li>简单说，如果要存储中文，就选 TEXT。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35440678/article/details/51793658">推荐阅读</a></p>
<h4 id="11-什么情况下设置了索引但无法使用"><a href="#11-什么情况下设置了索引但无法使用" class="headerlink" title="11. 什么情况下设置了索引但无法使用"></a>11. 什么情况下设置了索引但无法使用</h4><ol>
<li>以“%”开头的LIKE语句，模糊匹配</li>
<li>OR语句前后没有同时使用索引</li>
<li>数据类型出现隐式转化（如varchar不加单引号的话可能会自动转换为int型）</li>
</ol>
<h4 id="12-解释MySQL外连接、内连接与自连接的区别"><a href="#12-解释MySQL外连接、内连接与自连接的区别" class="headerlink" title="12. 解释MySQL外连接、内连接与自连接的区别"></a>12. 解释MySQL外连接、内连接与自连接的区别</h4><ul>
<li>先说什么是交叉连接: 交叉连接又叫笛卡尔积，它是指不使用任何条件，直接将一个表的所有记录和另一个表中的所有记录一一匹配。</li>
<li>内连接 则是只有条件的交叉连接，根据某个条件筛选出符合条件的记录，不符合条件的记录不会出现在结果集中，即内连接只连接匹配的行。</li>
<li>外连接 其结果集中不仅包含符合连接条件的行，而且还会包括左表、右表或两个表中的所有数据行，这三种情况依次称之为左外连接，右外连接，和全外连接。</li>
<li>左外连接，也称左连接，左表为主表，左表中的所有记录都会出现在结果集中，对于那些在右表中并没有匹配的记录，仍然要显示，右边对应的那些字段值以NULL来填充。</li>
<li>右外连接，也称右连接，右表为主表，右表中的所有记录都会出现在结果集中。</li>
</ul>
<p><strong>左连接和右连接可以互换，MySQL目前还不支持全外连接。</strong></p>
<h4 id="13-悲观锁和乐观锁的-sql-实现"><a href="#13-悲观锁和乐观锁的-sql-实现" class="headerlink" title="13. 悲观锁和乐观锁的 sql 实现"></a>13. 悲观锁和乐观锁的 sql 实现</h4><p><strong>悲观锁：</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Begin Tran</span><br><span class="line">select top 1 @<span class="attribute">TrainNo</span>=T_NO</span><br><span class="line"><span class="keyword">from</span> Train_ticket with (UPDLOCK)  </span><br><span class="line">where <span class="attribute">S_Flag</span>=0  </span><br><span class="line">update Train_ticket  user,  <span class="attribute">T_Time</span>=getdate(),   <span class="attribute">S_Flag</span>=1  </span><br><span class="line">where <span class="attribute">T_NO</span>=@TrainNo </span><br><span class="line">commit</span><br></pre></td></tr></table></figure>

<p>查询的时候使用了with (UPDLOCK)选项,在查询记录的时候我们就对记录加上了更新锁,表示我们即将对此记录进行更新。其他用户还可以查询此表的内容，但其他更新用户就会阻塞。</p>
<p><strong>乐观锁：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> 首先给表加一列 <span class="type">timestamp</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> ttt <span class="keyword">ADD</span> timesFlag <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> 然后更新时判断这个值是否被修改</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@count</span> <span class="keyword">as</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@flag</span> <span class="keyword">AS</span> <span class="type">TIMESTAMP</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@rowCount</span> <span class="keyword">AS</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">begin</span> tran</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@count</span><span class="operator">=</span>COUNT,<span class="variable">@flag</span><span class="operator">=</span>timesFlag<span class="operator">=</span><span class="variable">@flag</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@rowCount</span><span class="operator">=</span>@<span class="variable">@ROWCOUNT</span></span><br><span class="line"><span class="keyword">commit</span> tran</span><br><span class="line">IF <span class="variable">@rowCount</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">PRINT ‘’更新成功”</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">    PRINT”更新失败”</span><br></pre></td></tr></table></figure>

<p>　这便是乐观锁的解决方案，可以解决并发带来的数据错误问题，但不保证每一次调用更新都成功，可能会返回’更新失败’</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chenwolong/p/Lock.html">推荐阅读</a></p>
<h4 id="14-spring-MVC-和-Spring-boot-的区别"><a href="#14-spring-MVC-和-Spring-boot-的区别" class="headerlink" title="14. spring MVC 和 Spring boot 的区别"></a>14. spring MVC 和 Spring boot 的区别</h4><p><strong>SpringMVC：</strong></p>
<ol>
<li>   SpringMVC是Spring提供的一个强大而灵活的模块式web框架。通过Dispatcher Servlet, ModelAndView 和 View Resolver，开发web应用变得很容易。</li>
<li>   SpringMVC是一种基于Java的以请求为驱动类型的轻量级Web框架，其目的是将Web层进行解耦，即使用“请求-响应”模型，从工程结构上实现良好的分层，区分职责，简化Web开发。借助于注解，Spring MVC提供了几乎是POJO的开发模式，使得控制器的开发和测试更加简单。这些控制器一般不直接处理请求，而是将其委托给Spring上下文中的其他bean，通过Spring的依赖注入功能，这些bean被注入到控制器中。</li>
<li>   Spring框架最核心的就是所谓的依赖注射和控制反转。完全解耦类之间的依赖关系，一个类如果要依赖什么，那就是一个接口。至于如何实现这个接口，这都不重要了。只要拿到一个实现了这个接口的类，就可以轻松的通过xml配置文件把实现类注射到调用接口的那个类里。所有类之间的这种依赖关系就完全通过配置文件的方式替代了。</li>
</ol>
<p><strong>SpringBoot：</strong></p>
<ol>
<li>   Spring Boot引入自动配置的概念，让项目设置变得很容易。Spring Boot本身并不提供Spring框架的核心特性以及扩展功能，只是用于快速、敏捷地开发新一代基于Spring框架的应用程序，大部分的Spring Boot应用都只需要非常少量的配置代码，开发者能够更加专注于业务逻辑。</li>
<li>   Spring Boot只是承载者，辅助开发者简化项目搭建过程的。如果承载的是WEB项目，使用Spring MVC作为MVC框架，那么工作流程和SpringMVC的是完全一样的，因为这部分工作是Spring MVC做的而不是Spring Boot。</li>
</ol>
<p><strong>联系：</strong></p>
<ul>
<li>Spring 最初利用“工厂模式”（ DI ）和“代理模式”（ AOP ）解耦应用组件。按照这种模式搞了一个 MVC 框架（一些用 Spring 解耦的组件），用开发 web 应用（ SpringMVC ）。</li>
<li>后来发现每次开发都要搞很多依赖，写很多样板代码，使代码臃肿而麻烦，于是聪明的前人整理了一些懒人整合包（ starter ），这套就是 Spring Boot 。</li>
</ul>
<p><strong>区别：</strong></p>
<ul>
<li>Spring MVC 是基于 Servlet 的一个 MVC框架 主要解决 WEB 开发的问题 但关于Spring 的配置比较 ；</li>
<li>而Spring boot 的原则是：约定优于配置 ，可以极大地简化了 spring 的配置流程。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/piwefei/p/9149973.html">推荐阅读</a></p>
<h4 id="15-类加载机制中，什么时候进行静态变量的初始化"><a href="#15-类加载机制中，什么时候进行静态变量的初始化" class="headerlink" title="15. 类加载机制中，什么时候进行静态变量的初始化"></a>15. 类加载机制中，什么时候进行静态变量的初始化</h4><p>静态变量的初始化是在类被初始化时（类加载过程中的初始化阶段）进行的。而这个类，只有被首次主动使用时，才会被初始化。</p>
<p>主动使用的情况有六类：</p>
<ol>
<li>通过 new 关键词。</li>
<li>访问类的静态变量（但 final 修饰的静态变量实质上是静态常量，不属于此范畴，不会初始化类）。</li>
<li>访问类的静态方法。</li>
<li>对类进行反射操作。</li>
<li>初始化子类会导致父类的初始化。</li>
<li>启动类。也就是 main 函数所在的类会被初始化。</li>
</ol>
<p>参考本站另一篇博文：<a target="_blank" rel="noopener" href="http://likehui.fun/2018/12/22/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E7%AC%94%E8%AE%B0/">类加载机制笔记</a></p>
<h4 id="16-线程池的拒绝策略"><a href="#16-线程池的拒绝策略" class="headerlink" title="16. 线程池的拒绝策略"></a>16. 线程池的拒绝策略</h4><ol>
<li>CallerRunsPolicy：线程调用运行该任务的 execute 本身。这个策略显然不想放弃执行任务。但是由于池中已经没有任何资源了，那么就直接使用调用该execute的线程本身来执行。</li>
<li>AbortPolicy：处理程序遭到拒绝将抛出运行时 RejectedExecutionException。这种策略直接抛出异常，丢弃任务。</li>
<li>DiscardPolicy：不能执行的任务将被删除。这种策略和AbortPolicy几乎一样，也是丢弃任务，只不过他不抛出异常。</li>
<li>DiscardOldestPolicy：如果执行程序尚未关闭，则位于工作队列头部的任务将被删除，然后重试执行程序。该策略就稍微复杂一些，在pool没有关闭的前提下首先丢掉缓存在队列中的最早的任务，然后重新尝试运行该任务。</li>
</ol>
<h4 id="17-GC-Roots-有哪些？"><a href="#17-GC-Roots-有哪些？" class="headerlink" title="17. GC Roots 有哪些？"></a>17. GC Roots 有哪些？</h4><p>所谓“GC roots”，或者说tracing GC的“根集合”，就是<strong>一组必须活跃的引用</strong>（而不是对象）</p>
<p>这些引用可能包括：</p>
<ol>
<li>所有Java线程当前活跃的栈帧里指向GC堆里的对象的引用；换句话说，当前所有正在被调用的方法的引用类型的参数&#x2F;局部变量&#x2F;临时值。</li>
<li>VM的一些静态数据结构里指向GC堆里的对象的引用，例如说HotSpot VM里的Universe里有很多这样的引用。</li>
<li>JNI handles，包括global handles和local handles</li>
<li>（看情况）所有当前被加载的Java类</li>
<li>（看情况）Java类的引用类型静态变量</li>
<li>（看情况）Java类的运行时常量池里的引用类型常量（String或Class类型）</li>
<li>（看情况）String常量池（StringTable）里的引用</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/leishenop/article/details/53728605">推荐阅读</a></p>

      
    </div>

    

<!--以下为新增 -->
<div>
  
    <div>
    
        <div style="text-align:center;color: #555;font-size:14px;">-------------The End-------------</div>
    
</div>
  
</div>

<!--以上为新增 -->

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/javaWeb/" rel="tag"><i class="fa fa-tag"></i> javaWeb</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/13/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%862/" rel="next" title="面经整理2">
                <i class="fa fa-chevron-left"></i> 面经整理2
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/14/%E9%9D%A2%E7%BB%8F%E6%95%B4%E7%90%86%EF%BC%88%E5%A5%BD%E5%8F%8B%E6%8A%95%E7%A8%BF%EF%BC%89/" rel="prev" title="面经整理（好友投稿）">
                面经整理（好友投稿） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Harrison Lee / Email (harrisonli60@163.com)</p>
              <p class="site-description motion-element" itemprop="description">It is never too late to learn a new skill, even a challenging one.</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/%20%7C%7C%20archive">
                
                    <span class="site-state-item-count">154</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E3%80%81%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span class="nav-number">1.</span> <span class="nav-text">1. 数据库主从同步、读写分离</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-MySQL-%E4%B8%8A%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">2. MySQL 上主从同步如何配置，工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%9B%BE"><span class="nav-number">3.</span> <span class="nav-text">3. 线程的状态转换图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-wait-%E5%92%8Csleep-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.</span> <span class="nav-text">4. wait()和sleep()的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81%EF%BC%9A%E7%BB%99%E5%AE%9A%E5%A4%A7%E5%B0%8F%E4%B8%BAn%E7%9A%84%E6%95%B0%E7%BB%84%EF%BC%8C%E6%89%BE%E5%87%BA%E7%AC%ACK%E5%B0%8F%E7%9A%84%E5%85%83%E7%B4%A0"><span class="nav-number">5.</span> <span class="nav-text">5. 手撕代码：给定大小为n的数组，找出第K小的元素</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%95%BF%E5%BA%A6%E4%B8%BA-n-%E7%9A%84%E6%95%B0%E7%BB%84%E4%B8%AD%EF%BC%8C%E5%AF%BB%E6%89%BE%E7%AC%AC-K-%E5%B0%8F%E7%9A%84%E5%85%83%E7%B4%A0"><span class="nav-number">5.1.</span> <span class="nav-text">长度为 n 的数组中，寻找第 K 小的元素</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">6.</span> <span class="nav-text">6.  线程同步的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-spring-%E7%AE%A1%E7%90%86%E7%9A%84controller%E6%98%AF%E5%8D%95%E4%BE%8B%E7%9A%84%EF%BC%8C%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84%EF%BC%9F"><span class="nav-number">7.</span> <span class="nav-text">7. spring 管理的controller是单例的，怎么实现的？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8JDBC-%E6%97%B6%E9%9C%80%E8%A6%81%E5%8F%8D%E5%B0%84"><span class="nav-number">8.</span> <span class="nav-text">8. 为什么使用JDBC 时需要反射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-mysql-%E4%B8%AD-char-%E5%92%8C-varchar-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">9.</span> <span class="nav-text">9. mysql 中 char 和 varchar 的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-BLOB%E5%92%8CTEXT%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="nav-number">10.</span> <span class="nav-text">10. BLOB和TEXT有什么区别？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E8%AE%BE%E7%BD%AE%E4%BA%86%E7%B4%A2%E5%BC%95%E4%BD%86%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="nav-number">11.</span> <span class="nav-text">11. 什么情况下设置了索引但无法使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-%E8%A7%A3%E9%87%8AMySQL%E5%A4%96%E8%BF%9E%E6%8E%A5%E3%80%81%E5%86%85%E8%BF%9E%E6%8E%A5%E4%B8%8E%E8%87%AA%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">12.</span> <span class="nav-text">12. 解释MySQL外连接、内连接与自连接的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-%E6%82%B2%E8%A7%82%E9%94%81%E5%92%8C%E4%B9%90%E8%A7%82%E9%94%81%E7%9A%84-sql-%E5%AE%9E%E7%8E%B0"><span class="nav-number">13.</span> <span class="nav-text">13. 悲观锁和乐观锁的 sql 实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#14-spring-MVC-%E5%92%8C-Spring-boot-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">14.</span> <span class="nav-text">14. spring MVC 和 Spring boot 的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E4%B8%AD%EF%BC%8C%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E8%BF%9B%E8%A1%8C%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">15.</span> <span class="nav-text">15. 类加载机制中，什么时候进行静态变量的初始化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#16-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5"><span class="nav-number">16.</span> <span class="nav-text">16. 线程池的拒绝策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#17-GC-Roots-%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="nav-number">17.</span> <span class="nav-text">17. GC Roots 有哪些？</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harrison Lee / Email (harrisonli60@163.com)</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v6.3.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.0.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.0"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.0"></script>
<script src="/js/src/post-details.js?v=7.0.0"></script>



  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>



  


  


  

  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function(i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap');
      $(e).after($wrap);
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function(e) {
        var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
          return $(e).text();
        }).toArray().join('\n');
        var ta = document.createElement('textarea');
        var range = document.createRange(); //For Chrome
        var sel = window.getSelection(); //For Chrome
        var yPosition = window.pageYOffset || document.documentElement.scrollTop;
        ta.style.top = yPosition + 'px'; //Prevent page scroll
        ta.style.position = 'absolute';
        ta.style.opacity = '0';
        ta.value = code;
        ta.textContent = code; //For FireFox
        ta.contentEditable = true;
        ta.readOnly = false;
        document.body.appendChild(ta);
        range.selectNode(ta);
        sel.removeAllRanges();
        sel.addRange(range);
        ta.setSelectionRange(0, code.length);
        var result = document.execCommand('copy');
        
          if (result) $(this).text('Copied');
          else $(this).text('Copy failed');
        
        ta.blur(); //For iOS
        $(this).blur();
      })).on('mouseleave', function(e) {
        var $b = $(this).find('.copy-btn');
        setTimeout(function() {
          $b.text('Copy');
        }, 300);
      }).append(e);
    })
  </script>


  

</body>
</html>
